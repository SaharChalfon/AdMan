<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>AdMan â€“ Settings</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Lora:wght@400;600&family=Montserrat:wght@600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css"/>
</head>
<body>
<header class="topbar">
  <div class="wrap">
    <div class="brand"><span class="dot"></span> AdMan</div>
    <div style="display:flex;align-items:center;gap:10px">
      <span id="userEmail"></span>
      <button class="btn ghost" id="logoutBtn">Sign out</button>
    </div>
  </div>
</header>

<div class="layout">
  <aside class="sidebar">
    <nav class="nav">
      <a href="dashboard.html">Dashboard</a>
      <a href="banners.html">Banner Editor</a>
      <a href="emails.html">Email Editor</a>
      <a href="landings.html">Landing Editor</a>
      <a href="settings.html">Settings</a>
    </nav>
  </aside>

  <main class="main">
    <h1 style="margin-top:0">Settings</h1>
    <div class="card" style="padding:16px">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div>
          <div style="font-weight:700;margin-bottom:6px">Data reset</div>
          <div style="color:var(--sub)">Clear all LocalStorage data for AdMan</div>
        </div>
        <button class="btn warn" id="reset">Reset all data</button>
      </div>
    </div>
  </main>
</div>

<div class="toast"></div>

<script type="module">
import { authGate, initTopbar, wireSidebarActive, toast } from './app.js';

authGate();
initTopbar();
wireSidebarActive();

// Reset all adman.* keys and sign out
document.querySelector('#reset').addEventListener('click', () => {
  if (confirm('This will remove all saved banners, emails, landings and the user session. Continue?')) {
    try {
      Object.keys(localStorage)
        .filter(k => k.startsWith('adman.'))
        .forEach(k => localStorage.removeItem(k));

      toast('All AdMan data cleared');
      // Redirect to login after a short delay
      setTimeout(() => {
        window.location.href = 'login.html';
      }, 600);

    } catch (err) {
      console.error(err);
      toast('Failed to clear data', 'error');
    }
  }
});
</script>
</body>
</html>
